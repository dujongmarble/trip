<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dj.trip.domain.attractionInfo.mapper.AttractionInfoMapper">
    <select id="selectAttractionInfoListBySidoId" resultType="AttractionInfoVo">
        select attraction_info_id, sido_id, name, addr, url, description, latitude, longitude
        from attraction_info
        where sido_id = #{sidoId}
    </select>

    <select id="selectAttractionInfoByMemberBoardMapId" resultType="AttractionInfoVo">
        select ai.attraction_info_id, ai.sido_id, ai.name, ai.addr, ai.url, ai.description, ai.latitude, ai.longitude
        from member_board_map mbm
        join board b on mbm.member_board_map_id = b.member_board_map_id
        join attraction_info ai on b.attraction_info_id = ai.attraction_info_id
        where mbm.member_board_map_id = #{memberBoardMapId}
        and b.location = mbm.now_location;
    </select>

    <select id="selectAttractionInfoByMemberId" parameterType="String" resultType="GetAttractionInfoByMemberIdResponse">
        select b.member_board_log_id                   as boardLogId,
               a.attraction_info_id,
               a.name,
               a.url,
               s.name                                  as sidoName,
               b.create_date,
               if(count(r.review_id) = 0, false, true) as isWrite
        from member_board_log b
                 join attraction_info a
                      on b.attraction_info_id = b.attraction_info_id
                 join sido s
                      on a.sido_id = s.sido_id
                 left join review r
                           on a.attraction_info_id = r.attraction_info_id
        where b.member_id = "sdf"
        group by b.member_board_log_id,
                 a.attraction_info_id,
                 s.sido_id limit 0,20
    </select>
</mapper>